<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Horses</title>
  <!-- Bootstrap CSS (example) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome (for icons) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <style>
    /* General Page Styling */
    body {
      margin: 0;
      padding: 0;
      background-color: #faf9f7;
      font-family: "Arial", sans-serif;
      color: #333;
    }

    /* Heading & Button Row */
    .heading-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }
    .heading-row h1 {
      margin: 0;
      font-size: 2rem;
      color: #6c757d;
    }

    /* Offcanvas Sidebar Header */
    .offcanvas-header {
      border-bottom: 1px solid #dee2e6;
    }

    /* Offcanvas Title */
    .offcanvas-title {
      color: #6c757d;
    }

    /* Cards: rounded corners, slight hover transform, etc. */
    .card.custom-card {
      border-radius: 10px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      overflow: hidden;
      background-color: #ebcab5; /* Unified background color for cards */
      cursor: pointer;
    }
    .card.custom-card:hover {
      transform: scale(1.02);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    /* Image within the card */
    .card-img-top {
      border: 1px solid #ccc;
      border-radius: 8px;
    }

    /* Magnifying Glass Button */
    .btn.btn-outline-secondary {
      border-color: #6c757d;
      color: #6c757d;
    }
    .btn.btn-outline-secondary:hover {
      background-color: #6c757d;
      color: #fff;
    }

    /* Primary Button (Search, Book) */
    .btn.btn-primary {
      background-color: #007bff;
      border-color: #007bff;
    }

    /* Secondary Button (Close) */
    .btn.btn-secondary {
      background-color: #6c757d;
      border-color: #6c757d;
    }

    /* Form controls */
    .form-control {
      border-radius: 5px;
    }

    /* Modal: same background as card */
    .modal-content {
      background-color: #ebcab5;
      border-radius: 10px;
    }

    /* Modal header/footer: override default backgrounds if desired */
    .modal-header, .modal-footer {
      border: none;
      background-color: transparent; /* Let the parent's background show through */
    }
  </style>
</head>

<body>
  <!-- Container -->
  <div class="container my-4">
    <!-- Heading & Magnifying Glass button in one row -->
    <div class="heading-row">
      <h1>Horses</h1>
      <!-- Magnifying Glass Button triggers offcanvas -->
      <button class="btn btn-outline-secondary"
              type="button"
              data-bs-toggle="offcanvas"
              data-bs-target="#filterOffcanvas"
              aria-controls="filterOffcanvas">
        <i class="fa fa-search"></i>
      </button>
    </div>

    <!-- Offcanvas Sidebar -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="filterOffcanvas" aria-labelledby="filterOffcanvasLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="filterOffcanvasLabel">Filter Horses</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <%= form_with(url: horses_path, method: :get, local: true) do %>
          <!-- Name -->
          <div class="mb-3">
            <%= label_tag :name, "Name" %>
            <%= text_field_tag :name, params[:name], class: "form-control" %>
          </div>
          <!-- Breed -->
          <div class="mb-3">
            <%= label_tag :breed, "Breed" %>
            <%= text_field_tag :breed, params[:breed], class: "form-control" %>
          </div>
          <!-- Age: Min/Max -->
          <div class="mb-3">
            <%= label_tag :age_min, "Min Age" %>
            <%= number_field_tag :age_min, params[:age_min], class: "form-control" %>
          </div>
          <div class="mb-3">
            <%= label_tag :age_max, "Max Age" %>
            <%= number_field_tag :age_max, params[:age_max], class: "form-control" %>
          </div>
          <!-- Location -->
          <div class="mb-3">
            <%= label_tag :location, "Location" %>
            <%= text_field_tag :location, params[:location], class: "form-control" %>
          </div>
          <!-- Stud Fee: Min/Max -->
          <div class="mb-3">
            <%= label_tag :stud_fee_min, "Min Stud Fee" %>
            <%= number_field_tag :stud_fee_min, params[:stud_fee_min], step: 0.01, class: "form-control" %>
          </div>
          <div class="mb-3">
            <%= label_tag :stud_fee_max, "Max Stud Fee" %>
            <%= number_field_tag :stud_fee_max, params[:stud_fee_max], step: 0.01, class: "form-control" %>
          </div>
          <!-- Pedigree -->
          <div class="mb-3">
            <%= label_tag :pedigree, "Pedigree" %>
            <%= text_field_tag :pedigree, params[:pedigree], class: "form-control" %>
          </div>
          <!-- Progeny Success -->
          <div class="mb-3">
            <%= label_tag :progeny_success, "Progeny Success" %>
            <%= text_field_tag :progeny_success, params[:progeny_success], class: "form-control" %>
          </div>
          <!-- Race Record -->
          <div class="mb-3">
            <%= label_tag :race_record, "Race Record" %>
            <%= text_field_tag :race_record, params[:race_record], class: "form-control" %>
          </div>
          <!-- Submit button -->
          <%= submit_tag "Search",  class: "btn btn-primary w-100" %>
        <% end %>
      </div>
    </div>

    <!-- Row with columns -->
    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4 p-3">
      <% @horses.each do |horse| %>
        <div class="col">
          <!-- Card -->
          <div class="card custom-card h-100 p-3"
               data-bs-toggle="modal"
               data-bs-target="#horseModal-<%= horse.id %>">
            <!-- Image -->
            <%= image_tag "backup-image.png",
                alt: "No Image",
                class: "card-img-top img-fluid border rounded mb-3" %>

            <!-- Card Body -->
            <div class="card-body">
              <h5 class="card-title"><%= horse.name %></h5>
              <p class="card-text">
                <strong>Location:</strong> <%= horse.location %><br>
                <strong>Stud Fee:</strong> <%= number_to_currency(horse.stud_fee) %>
              </p>
            </div>
          </div>

          <!-- Modal (same color as card) -->
          <div class="modal fade"
               id="horseModal-<%= horse.id %>"
               tabindex="-1"
               aria-labelledby="horseModalLabel-<%= horse.id %>"
               aria-hidden="true">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                <!-- Header -->
                <div class="modal-header">
                  <h5 class="modal-title" id="horseModalLabel-<%= horse.id %>">
                    <%= horse.name %>
                  </h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <!-- Body -->
                <div class="modal-body">
                  <%= image_tag "backup-image.png", alt: "No Image", class: "img-fluid mb-3" %>
                  <p>
                    <strong>Breed:</strong> <%= horse.breed %><br>
                    <strong>Age:</strong> <%= horse.age %><br>
                    <strong>Location:</strong> <%= horse.location %><br>
                    <strong>Stud Fee:</strong> <%= number_to_currency(horse.stud_fee) %><br>
                    <strong>Pedigree:</strong> <%= horse.pedigree %><br>
                    <strong>Progeny Success:</strong> <%= horse.progeny_success %><br>
                    <strong>Race Record:</strong> <%= horse.race_record %>
                  </p>
                </div>
                <!-- Footer -->
                <div class="modal-footer">
                  <%= link_to "Book", horse_path(horse), class: "btn btn-primary" %>
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fa fa-times"></i> Close
                  </button>
                </div>
              </div>
            </div>
          </div>
          <!-- End Modal -->
        </div>
      <% end %>
    </div>
  </div>

  <!-- Bootstrap JS (example) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
